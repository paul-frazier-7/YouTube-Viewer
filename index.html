<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Minimal YouTube Embed</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="data:,">
  <style>
    body {
      margin: 0;
      display: flex;
      flex-direction: column;
      height: 100vh;
      background: #000;
      color: #fff;
      font-family: sans-serif;
    }

    #controls {
      padding: 10px;
      background: #111;
      display: flex;
      gap: 10px;
      align-items: center;
    }

    input {
      flex: 1;
      padding: 8px;
      border: none;
      border-radius: 4px;
      font-size: 14px;
    }

    button {
      padding: 8px 12px;
      border: none;
      border-radius: 4px;
      background: #e62117;
      color: #fff;
      font-size: 14px;
      cursor: pointer;
    }

    button:hover {
      background: #cc1c13;
    }

    #player {
      flex: 1;
      display: flex;
    }

    iframe {
      width: 100%;
      height: 100%;
      border: none;
    }
  </style>
</head>
<body>
  <div id="controls">
    <input type="text" id="youtubeUrl" placeholder="Paste YouTube link here...">
    <button onclick="loadVideo()">Load Video</button>
  </div>

  <div id="player">
    <iframe
      id="youtubeFrame"
      src=""
      allow="autoplay; encrypted-media"
      allowfullscreen>
    </iframe>
  </div>

  <script>
    function extractVideoId(input) {
      if (!input) return null;

      const cleaned = input.trim();

      // If user pastes a raw 11-char video ID.
      if (/^[a-zA-Z0-9_-]{11}$/.test(cleaned)) {
        return cleaned;
      }

      // Fast path for common YouTube URL shapes anywhere in the pasted text.
      const directMatch = cleaned.match(
        /(?:youtube\.com\/(?:watch\?v=|live\/|embed\/|shorts\/)|youtu\.be\/)([a-zA-Z0-9_-]{11})/
      );
      if (directMatch) {
        return directMatch[1];
      }

      try {
        const url = new URL(cleaned);
        const host = url.hostname.replace(/^www\./, '');

        if (host === 'youtu.be') {
          const id = url.pathname.slice(1).split('/')[0] || null;
          return /^[a-zA-Z0-9_-]{11}$/.test(id || '') ? id : null;
        }

        if (
          host === 'youtube.com' ||
          host === 'm.youtube.com' ||
          host === 'music.youtube.com'
        ) {
          // Standard watch URL: /watch?v=VIDEO_ID
          const vParam = url.searchParams.get('v');
          if (/^[a-zA-Z0-9_-]{11}$/.test(vParam || '')) return vParam;

          // Supports /live/VIDEO_ID, /embed/VIDEO_ID, /shorts/VIDEO_ID
          const parts = url.pathname.split('/').filter(Boolean);
          const keyIndex = parts.findIndex(part =>
            part === 'live' || part === 'embed' || part === 'shorts'
          );

          if (keyIndex !== -1 && parts[keyIndex + 1]) {
            const id = parts[keyIndex + 1];
            if (/^[a-zA-Z0-9_-]{11}$/.test(id)) return id;
          }
        }
      } catch (_) {
        return null;
      }

      return null;
    }

    function updateYouTubeVideo(videoId) {
      const iframe = document.getElementById('youtubeFrame');
      const params = new URLSearchParams({
        autoplay: '1',
        rel: '0',
        modestbranding: '1',
        iv_load_policy: '3',
        playsinline: '1',
        controls: '1'
      });

      // YouTube embeds are more reliable when a valid HTTP(S) origin/referrer exists.
      if (window.location.protocol === 'http:' || window.location.protocol === 'https:') {
        params.set('origin', window.location.origin);
        params.set('widget_referrer', window.location.href);
      }

      iframe.src = `https://www.youtube.com/embed/${videoId}?${params.toString()}`;
    }

    function loadVideo() {
      const url = document.getElementById('youtubeUrl').value.trim();
      const videoId = extractVideoId(url);

      if (videoId) {
        updateYouTubeVideo(videoId);
      } else {
        alert('Invalid YouTube URL');
      }
    }
  </script>
</body>
</html>
